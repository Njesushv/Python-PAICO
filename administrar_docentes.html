<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Administrar Docentes</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      background-color: #f8f9fa;
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 40px;
    }

    .contenedor-grande {
      max-width: 1500px;
      margin: auto;
    }

    /* CARD PRINCIPAL */
    .card {
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      animation: fadeIn .35s ease;
    }

    .card-header {
      background-color: #1d3557;
      color: #ffffff;
      font-weight: 600;
    }

    .btn {
      border-radius: 20px;
      font-weight: 500;
      padding: 6px 14px !important;
      font-size: 13px !important;
      transition: all 0.15s ease-in-out;
    }

    .btn-primary {
      background-color: #1d3557;
      border-color: #1d3557;
    }

    .btn-primary:hover {
      background-color: #12263f;
      border-color: #12263f;
    }

    .btn-success,
    .btn-danger {
      border-radius: 20px;
    }

    table th, table td {
      text-align: center !important;
      vertical-align: middle !important;
      padding: 6px 10px !important;
      font-size: 13px;
      line-height: 1.2;
    }

    table thead th {
      background-color: #1d3557;
      color: #ffffff;
      font-weight: 600;
      font-size: 13px;
    }

    .table-striped > tbody > tr:nth-of-type(odd) > * {
      background-color: #f1f5fa;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <div class="container contenedor-grande">
    <div class="card">

      <!-- HEADER -->
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
          <i class="bi bi-person-vcard"></i> Administración de Docentes
        </h5>
        <a href="{{ url_for('dashboard') }}" class="btn btn-light btn-sm">
          <i class="bi bi-arrow-left-circle"></i> Volver
        </a>
      </div>

      <!-- BODY -->
      <div class="card-body">

        <div class="mb-3 d-flex gap-2">
          <a href="{{ url_for('agregar_docente') }}" class="btn btn-success">
            <i class="bi bi-person-plus"></i> Agregar Docente
          </a>

          <button id="btnEditar" class="btn btn-primary" disabled>
            <i class="bi bi-pencil-square"></i> Editar Docente
          </button>

          <button id="btnEliminar" class="btn btn-danger" disabled>
            <i class="bi bi-trash"></i> Eliminar Docente
          </button>
        </div>

        <div class="table-responsive shadow-sm">
          <table id="tablaDocentes" class="table table-hover table-striped table-bordered align-middle text-center mb-0">
            <thead>
              <tr>
                <th style="width: 50px;">
                  <input type="checkbox" id="selectAll" title="Seleccionar todos">
                </th>
                <th>ID</th>
                <th>Nombre</th>
                <th>DNI</th>
                <th>Celular</th>
                <th>Correo</th>
                <th>Especialidad</th>
                <th>Profesión</th>
                <th>Curso Asignado</th>
                <th>Sede</th>
                <th>Horario</th>
              </tr>
            </thead>
            <tbody>
              {% for d in docentes %}
              <tr data-id="{{ d.id_docente }}">
                <td><input type="checkbox" class="check-docente"></td>
                <td>{{ d.id_docente }}</td>
                <td>{{ d.nombres }}</td>
                <td>{{ d.dni }}</td>
                <td>{{ d.celular or '-' }}</td>
                <td>{{ d.correo or '-' }}</td>
                <td>{{ d.especialidad or '-' }}</td>
                <td>{{ d.profesion or '-' }}</td>
                <td>{{ d.curso_nombre or 'Sin asignar' }}</td>
                <td>{{ d.sede_nombre or 'Sin sede' }}</td>
                <td>
                  {% if d.horario_nombre %}
                    {{ d.horario_nombre }}<br>
                    <small class="text-muted">{{ d.hora_inicio }} - {{ d.hora_fin }}</small>
                  {% else %}
                    <em class="text-muted">Sin horario</em>
                  {% endif %}
                </td>
              </tr>
              {% else %}
              <tr>
                <td colspan="11" class="text-center text-muted py-4 no-docentes">
                  <i class="bi bi-info-circle"></i> No hay docentes registrados aún.
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>

  <script>
    const checkboxes = document.querySelectorAll(".check-docente");
    const selectAll  = document.getElementById("selectAll");
    const btnEditar  = document.getElementById("btnEditar");
    const btnEliminar= document.getElementById("btnEliminar");
    let idSeleccionado = null;

    checkboxes.forEach(chk => {
      chk.addEventListener("change", () => {
        checkboxes.forEach(c => { if (c !== chk) c.checked = false; });
        const fila = chk.closest("tr");
        idSeleccionado      = chk.checked ? fila.getAttribute("data-id") : null;
        btnEditar.disabled  = !idSeleccionado;
        btnEliminar.disabled= !idSeleccionado;
      });
    });

    selectAll.addEventListener("change", () => {
      checkboxes.forEach(chk => chk.checked = selectAll.checked);
      if (selectAll.checked && checkboxes.length > 0) {
        idSeleccionado      = checkboxes[0].closest("tr").getAttribute("data-id");
        btnEditar.disabled  = false;
        btnEliminar.disabled= false;
      } else {
        idSeleccionado      = null;
        btnEditar.disabled  = true;
        btnEliminar.disabled= true;
      }
    });

    btnEditar.addEventListener("click", () => {
      if (idSeleccionado) {
        window.location.href = `/editar_docente/${idSeleccionado}`;
      }
    });

    btnEliminar.addEventListener("click", () => {
      if (idSeleccionado && confirm("¿Seguro que deseas eliminar este docente?")) {
        window.location.href = `/eliminar_docente/${idSeleccionado}`;
      }
    });
  </script>
</body>
</html>
